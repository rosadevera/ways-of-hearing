<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Ways of Hearing</title>

  <script src="https://unpkg.com/meyda"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/addons/p5.sound.min.js"></script>

  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="sidebar" class="sidebar">
      <div class="sidebar-header">
          <h1>WAYS OF HEARING</h1>
          <p class="subtitle">a generative tool</p>
      </div>
      
      <div class="sidebar-content">
          <div class="control-section">
              <h3>01 / SOURCE</h3>
              <div class="control-group">
                  <label for="audio-upload">Audio File</label>
                  <div class="file-input-wrapper">
                      <input type="file" id="audio-upload" accept=".mp3,.wav,.ogg,.m4a" />
                      <div id="file-name" class="file-name">No file selected</div>
                  </div>
              </div>
          </div>

          <div class="control-section">
              <h3>02 / GRID</h3>
              <div class="control-group">
                  <label for="columns">Columns <span id="column-value">4</span></label>
                  <input type="range" id="columns" min="1" max="8" value="4">
              </div>
              
              <div class="control-group">
                  <label for="bpm-input">BPM</label>
                  <input id="bpm-input" type="number" value="120" min="40" max="240" step="1">
              </div>
          </div>

          <div class="control-section">
              <h3>03 / INSTRUMENT</h3>
              <div class="control-group">
                  <label for="category-select">Category</label>
                  <select id="category-select" class="category-select">
                      <option value="keys">01 / Keys and Harmonics</option>
                      <option value="percussion">02 / Drums and Percussion</option>
                      <option value="wind">03 / Wind and Brass</option>
                      <option value="strings">04 / Strings</option>
                      <option value="synths">05 / Synthesizers</option>
                  </select>
              </div>
          </div>

          <div class="control-section">
            <h3>04 / KEY AND MODE</h3>
            <p class="section-hint">Set the key and mode of the song to generate a cohesive colour palette for the composition.</p>

            <div class="control-group">
                <label for="key-select">Root Key</label>
                <select id="key-select">
                    <option value="C">C</option>
                    <option value="C#">C# / D♭</option>
                    <option value="D">D</option>
                    <option value="D#">D# / E♭</option>
                    <option value="E">E</option>
                    <option value="F">F</option>
                    <option value="F#">F# / G♭</option>
                    <option value="G" selected>G</option>
                    <option value="G#">G# / A♭</option>
                    <option value="A">A</option>
                    <option value="A#">A# / B♭</option>
                    <option value="B">B</option>
                </select>
            </div>

            <div class="control-group">
                <label for="mode-select">Mode</label>
                <select id="mode-select">
                    <option value="ionian">Ionian</option>
                    <option value="dorian">Dorian</option>
                    <option value="phrygian">Phrygian</option>
                    <option value="lydian">Lydian</option>
                    <option value="mixolydian">Mixolydian</option>
                    <option value="aeolian">Aeolian (Minor)</option>
                    <option value="locrian">Locrian</option>
                </select>
            </div>

            <button id="generate-palette-btn" class="palette-btn">Generate Palette</button>

            <!-- Swatch strip — filled by renderSwatches() in sketch.js -->
            <div id="palette-swatches" class="palette-swatches"></div>
        </div>

          <div class="control-section actions">
              <button id="analyze-btn" class="primary-btn">Generate Composition</button>
              <div class="button-group">
                  <button id="pause-btn">Pause</button>
                  <button id="reset-btn">Reset</button>
              </div>
              <button id="download-btn" class="download-btn">Download Composition</button>
          </div>

          <div id="loading" class="loading-indicator">
              <div class="spinner"></div>
              <span>Transcribing audio...</span>
          </div>
          <div id="status" class="status-message"></div>
      </div>
      
      <div class="sidebar-footer">
          <p>thesis project by rosa de vera · wip</p>
      </div>
  </div>

  <button id="menu-toggle" class="menu-toggle">
    <p><</p>
  </button>

  <!-- Main Canvas Container -->
  <main id="canvas-container">
      <!-- p5.js canvas will be inserted here -->
  </main>

  <script src="sketch.js"></script>
  
  <script>
    // Sidebar toggle functionality
    document.addEventListener('DOMContentLoaded', function() {
        const sidebar = document.getElementById('sidebar');
        const toggleBtn = document.getElementById('menu-toggle');
        
        toggleBtn.addEventListener('click', function() {
            sidebar.classList.toggle('collapsed');
            toggleBtn.classList.toggle('active');
            
            // Call the p5.js function to resize canvas
            if (window.onSidebarToggle) {
                window.onSidebarToggle();
            }
        });
    });
</script>
</body>
</html>
